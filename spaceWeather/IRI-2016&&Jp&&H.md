# IRI-2016

**IRI-2016模型解释**

IRI-2016是一个通过输入可以输出电离层参数的模型

电离层暴模式预测中，可以实现对foF2层的临界频率的预测

同时也可以实现电离层电子密度参数预测

**我需要IRI-2016模型实现什么**

在给定输入参数之后，电子密度预测方面进行损失比较

# Jp原理

原始数据：使用的数据来自太阳动力学天文台（SDO），时间分辨率12s到1小时。SDO以12 S的节奏持续捕捉全盘日冕，并用9个极紫外光通道记录日冕图像。图像分辨率为4096∗4096

获取原始数据之后，首先对数据进行筛选，每个通道都要进行筛选，尽量选取每个小时的相同时间的fits文件，没有的话用最近的文件代替（JSOC数据中心出问题没办法下载数据）。

将数据按年处理，每个图片为4096∗4096的数据，使用cv的三插值重采样为100*100，之后保存为8760x100x100的矩阵。提取每个矩阵元素，形成10，000个时间序列。然后将SWM应用于这些时间序列。最后，同时计算SWM结果的平均值，shape为（8760，）。

之后Savitzky-Golay滤波器被应用于GM(T)，通过使用线性最小二乘用低次多项式来拟合相邻散乱数据点的连续子集来对信号进行去噪，如果某点的值超出窗口中位数 `\pm 3\sigma`（`nsigma = 3`），则标记为离群点。窗口范围从40到100，找到最小化离群点数量。按照最佳窗口大小，对大矩阵进行去噪，对离群点使用前一个值代替。

之后大矩阵reshape为（10000，8760），并且分成五片，每个切片被切割成形状为 `(17520000,)`对9个通道每个切片进行延拓数据，快速傅里叶变换，高斯拟合，筛选条件后对残差进行二次高斯拟合，最后进行滤波与逆傅里叶变换

再将每个切片聚合成大矩阵（10000， 8760），对每个100*100的矩阵求中值，并按照每个通道的方向聚合成（7，8760）,舍去两个较低层太阳大气，对每个通道进行SG滤波，将离群点替换为中位数值，并且白谱会在开头和结尾引起不必要的异常值，将归为nan值，通过最小二乘法解多项式拟合，将nan值归0，在对所有通道求均值，得到最后的Jp指数



raw_data  fits文件 4096*4096的二维矩阵数据，一个小时一个文件，并行处理每一年的数据，保存为initial文件

AIA{波段}_initial.npy文件shape为(8760, 100, 100)，initial文件分析 单个像素点随时间变化的光强，并找到光强最强/最弱时刻对应的图像帧 存为AIA{波段}.npy文件

对AIA{波段}.npy文件重塑为(10000,8760) ，对数据进行切片，每个切片为（2000，8760）(2000行，8760列)，之后重塑为（17520000）的txt文件，保存为AIA{波段}_{切片}.txt

对每个AIA{波段}_{切片}.txt进行白谱法SWM处理，数据量没有发生变化，还是17520000,保存为py_AIA{波段}SWM__{切片}.txt

对每个py_AIA{波段}SWM__{切片}.txt，之后重塑为(2000行，8760列)，并合并成(10000行，8760列)，保存为py_SWM_AIA{波段}.npy

对py_SWM_AIA{波段}.npy(10000行，8760列)，每一行求中值，变为8760个数，之后按波段叠起来变为（7行，8760列）

# H分量

地磁场总强度 **F** 是三维矢量，在 **HDZ坐标系** 中的分解：

- **H**（水平分量）= 总矢量在水平面的投影
- **Z**（垂直分量）= 总矢量在垂直方向的投影
- **I**（倾角）= 总矢量与水平面的夹角

**几何关系推导**：

- 将 **F** 视为斜边，H 为邻边，Z 为对边：

  cos⁡(I)=HF ⇒ H=F⋅cos⁡(I)cos(*I*)=*F**H* ⇒ *H*=*F*⋅cos(*I*)

  sin⁡(I)=ZF ⇒ Z=F⋅sin⁡(I)sin(*I*)=*F**Z* ⇒ *Z*=*F*⋅sin(*I*)

**物理意义**：H 是总磁场在水平方向的分量，通过倾角投影得到。

在 **XYZ坐标系** 中，水平分量 **H** 可进一步分解为：

- **X**（北向分量）= H 在正北方向的投影
- **Y**（东向分量）= H 在正东方向的投影

**几何关系推导**：

- 若 **D** 为磁偏角（磁北与真北的夹角）：

  X=H⋅cos⁡(D),Y=H⋅sin⁡(D)*X*=*H*⋅cos(*D*),*Y*=*H*⋅sin(*D*)

- 因此：

  H=X2+Y2*H*=*X*2+*Y*2

**物理意义**：H 是北向和东向分量的矢量合成。



单个站点通过XY 求出H分量，一年有8760个数，对单个站点1998-2014年进行白谱法，得出16*8760个数，

按照同样方法对8个站点1998-2014年的数据进行白谱法，最后进行SWM